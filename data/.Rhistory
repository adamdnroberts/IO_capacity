'title' = s24_full$TITLE,
'subchapter' = s24_full$SUB.CHAPTER,
'unit' = s24_full$UNIT,
'true15' = s24_full$X2015,
'true16' = s24_full$X2016,
'true17' = s24_full$X2017,
'true18' = s24_full$X2018,
'true19' = s24_full$X2019,
'true20' = s24_full$X2020,
'true21' = s24_full$X2021,
'true22' = s24_full$X2022,
'true23' = s24_full$X2023)
#merging
s15 <- merge(s15nt, true3, by = c("country","subchapter","title","unit","code"))
a15 <- merge(a15nt, true3, by = c("country","subchapter","title","unit","code"))
y15 <- bind_rows(s15,a15)
y15$true14 <- NULL
y15$true18 <- NULL
y15$true19 <- NULL
y15$true20 <- NULL
y15$true21 <- NULL
y15$true22 <- NULL
y15$true23 <- NULL
y15 <- y15 %>%
dplyr::rename(true0 = true15, true1 = true16, true2 = true17)
test <- y15$p0 - y15$true0
summary(test)
test <- y15$p1 - y15$true1
summary(test)
test <- y15$p2 - y15$true2
summary(test)
s16 <- merge(s16nt, true3, by = c("country","subchapter","title","unit","code"))
a16 <- merge(a16nt, true3, by = c("country","subchapter","title","unit","code"))
View(s16)
y16 <- bind_rows(s16,a16)
y16$true15 <- NULL
y16$true19 <- NULL
y16$true20 <- NULL
y16$true21 <- NULL
y16$true22 <- NULL
y16$true23 <- NULL
#non_merged <- y16[is.na(y16$true16),]
#snm <- subset(non_merged, period == "spring")
#anm <- subset(non_merged, period == "autumn")
y16 <- y16 %>%
dplyr::rename(true0 = true16, true1 = true17, true2 = true18)
test <- y16$p0 - y16$true0
summary(test)
test <- y16$p1 - y16$true1
summary(test)
test <- y16$p2 - y16$true2
summary(test)
s17 <- merge(s17nt, true3, by = c("country","subchapter","title","unit","code"))
a17 <- merge(a17nt, true3, by = c("country","subchapter","title","unit","code"))
y17 <- bind_rows(s17,a17)
y17$true15 <- NULL
y17$true16 <- NULL
y17$true20 <- NULL
y17$true21 <- NULL
y17$true22 <- NULL
y17$true23 <- NULL
y17 <- y17 %>%
dplyr::rename(true0 = true17, true1 = true18, true2 = true19)
source("~/ecb_project/code/clean_data15_23.R", echo=TRUE)
View(full_dataset15_23)
unique(full_dataset15_23$subchapter)
source("~/ecb_project/code/merge_datasets.R", echo=TRUE)
setwd("C:/Users/adamd/OneDrive/Documents/ecb_project/data")
source("~/ecb_project/code/clean_data11_14.R", echo=TRUE)
source("~/ecb_project/code/merge_datasets.R", echo=TRUE)
load("~/ecb_project/data/final_dataset_euro_pooled.Rdata")
setDT(dfp)
# pool predictions dataset
df <- read.csv("~/ecb_project/data/final_dataset_euro.csv")
p0 <- subset(df, select = c("ecfin", "ecfin_int", "pop_int", "gdp", "country", "ysp", "subchapter", "title", "err0", "err0_sq", "rev", "exp", "lend", "spring"))
p0$py <- 0
p0$err_sq <- p0$err0_sq
p0$err <- p0$err0
p1 <- subset(df, select = c("ecfin", "ecfin_int", "pop_int", "gdp", "country", "ysp", "subchapter", "title", "err1", "err1_sq", "rev", "exp", "lend"))
p1$py <- 1
p1$err_sq <- p1$err1_sq
p1$err <- p1$err1
p2 <- subset(df, select = c("ecfin", "ecfin_int", "pop_int", "gdp", "country", "ysp", "subchapter", "title", "err2", "err2_sq", "rev", "exp", "lend"))
p2$py <- 2
p2$err_sq <- p2$err2_sq
p2$err <- p2$err2
p_list <- list(p0, p1, p2)
pooled_df <- do.call(plyr::rbind.fill, p_list)
pooled_df$aeoy <- 0
pooled_df$aeoy[pooled_df$py == 0 & pooled_df$spring == 0] <- 1
dfp <- pooled_df
save(dfp, file = "~/ecb_project/data/final_dataset_euro_pooled.Rdata")
load("~/ecb_project/data/final_dataset_euro_pooled.Rdata")
setDT(dfp)
unique(dfp$subchapter)
ggplot(dfp) +
geom_point(aes(x=ysp,y=err)) +
facet_wrap(~country)
ggplot(subset(dfp, lend == 1)) +
geom_point(aes(x=ysp,y=err)) +
facet_wrap(~country)
sort(unique(dfp$subchapter))
sort(unique(dfp$title[dfp$subchapter == "01 Revenue (ESA 2010)"]))
sort(unique(dfp$title[dfp$subchapter == "01 Revenue (ESA 1995)"]))
sort(unique(dfp$title[dfp$subchapter == "01 Revenue (ESA95)"]))
sort(variable.names(dfp))
sort(unique(dfp$title)
)
ggplot(subset(dfp, title == "Social contributions received: general government " )) +
geom_point(aes(x=ysp,y=err)) +
facet_wrap(~country)
sort(unique(dfp$subchapter))
rev <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, subchapter == "01 Revenue (ESA 2010)"))
#table 1
all <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp)
rev <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, subchapter == "01 Revenue (ESA 2010)"))
exp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, exp == 1 & title != "Total expenditure: general government "))
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, lend == 1))
etable(all,rev,exp,lend, tex=F)
#table 1
all <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp)
rev <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, subchapter == "01 Revenue (ESA 2010)"))
exp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, subchapter == "02 Expenditure (ESA 2010)"))
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, subchapter == "03 Net lending (ESA 2010)"))
etable(all,rev,exp,lend, tex=F)
sort(unique(dfp$title[dfp$subchapter == "03 Net lending (ESA 2010)""03 Net lending (ESA 2010)"]))
sort(unique(dfp$title[dfp$subchapter == "03 Net lending (ESA 2010)""03 Net lending (ESA 2010)"]))
sort(unique(dfp$title[dfp$subchapter == "03 Net lending (ESA 2010)"]))
final_dataset_euro <- read.csv("~/ecb_project/data/final_dataset_euro.csv")
df_merged_FULL <- merge(final_dataset_euro, gne_merge, by = c("country","ysp"), all = TRUE)
load("~/ecb_project/data/final_dataset_euro_plus_guide.RData")
#write.csv(hi, file = "~/ecb_project/data/final_dataset_euro_plus_guide.csv", row.names = FALSE)
load("~/ecb_project/data/final_dataset_euro_plus_guide.RData")
# pool predictions dataset
df <- read.csv("~/ecb_project/data/final_dataset_euro.csv")
rm(dfg)
p2$err <- p2$err2
p0 <- subset(df, select = c("ecfin", "ecfin_int", "pop_int", "gdp", "country", "ysp", "subchapter", "title", "err0", "err0_sq", "rev", "exp", "lend", "spring"))
p0$py <- 0
p0$err_sq <- p0$err0_sq
p0$err <- p0$err0
View(p0)
p0 <- p0 %>% rename(err_sq = err0_sq, err = err0)
library(tidyverse)
p0 <- p0 %>% rename(err_sq = err0_sq, err = err0)
df <- read.csv("~/ecb_project/data/final_dataset_euro.csv")
p0 <- subset(df, select = c("ecfin", "ecfin_int", "pop_int", "gdp", "country", "ysp", "subchapter", "title", "err0", "err0_sq", "rev", "exp", "lend", "spring"))
p0$py <- 0
p0 <- p0 %>% rename(err_sq = err0_sq, err = err0)
df <- read.csv("~/ecb_project/data/final_dataset_euro.csv")
p0 <- subset(df, select = c("ecfin", "ecfin_int", "pop_int", "gdp", "country", "ysp", "subchapter", "title", "err0", "err0_sq", "rev", "exp", "lend", "spring"))
p0$py <- 0
p0 <- p0 %>% rename(err_sq = err0_sq, err = err0)
p1 <- subset(df, select = c("ecfin", "ecfin_int", "pop_int", "gdp", "country", "ysp", "subchapter", "title", "err1", "err1_sq", "rev", "exp", "lend"))
p1$py <- 1
p1 <- p1 %>% rename(err_sq = err1_sq, err = err1)
p2 <- subset(df, select = c("ecfin", "ecfin_int", "pop_int", "gdp", "country", "ysp", "subchapter", "title", "err2", "err2_sq", "rev", "exp", "lend"))
p2$py <- 2
p2 <- p2 %>% rename(err_sq = err2_sq, err = err2)
# p2$err_sq <- p2$err2_sq
# p2$err <- p2$err2
p_list <- list(p0, p1, p2)
pooled_df <- do.call(plyr::rbind.fill, p_list)
pooled_df$aeoy <- 0
pooled_df$aeoy[pooled_df$py == 0 & pooled_df$spring == 0] <- 1
dfp <- pooled_df
View(dfp)
source("~/.active-rstudio-document", echo=TRUE)
?separate
unique(dfp$subchpater)
unique(dfp$subchapter)
dfp$subchapter %>% separate_wider_delim(subchapter, delim = " ", c('num', 'subchapter', "esa_sc"))
as.data.frame(dfp$subchapter) %>% separate_wider_delim(subchapter, delim = " ", c('num', 'subchapter', "esa_sc"))
as.data.frame(dfp$subchapter) %>% separate_wider_delim(subchapter, delim = " ")
as.data.frame(dfp$subchapter) %>% separate_wider_delim(subchapter, delim = " ", names = c('num', 'subchapter', "esa_sc"))
dfp %>% separate_wider_delim(subchapter, delim = " ", names = c('num', 'subchapter', "esa_sc"))
test <- subset(dfp, country == "Croatia" & ysp == "2015")
test %>% separate_wider_delim(subchapter, delim = " ", names = c('num', 'subchapter', "esa_sc"))
test %>% separate_wider_delim(subchapter, delim = "(", names = c('subchapter', "esa_sc"))
test %>% filter(subchapter != "04 Excessive deficit procedure") %>%separate_wider_delim(subchapter, delim = "(", names = c('subchapter', "esa_sc"))
test2 <- test %>% filter(subchapter != "04 Excessive deficit procedure") %>%separate_wider_delim(subchapter, delim = "(", names = c('subchapter', "esa_sc"))
View(test2)
test <- subset(dfp, country == "Croatia")
test2 <- test %>% filter(subchapter != "04 Excessive deficit procedure") %>%separate_wider_delim(subchapter, delim = "(", names = c('subchapter', "esa_sc"))
View(test2)
sort(unique(dfp$title[dfp$subchapter == "01 Revenue (ESA 2010)"]))
rev <- sort(unique(dfp$title[dfp$subchapter == "01 Revenue (ESA 2010)"]))
summary(dfp$rev)
dfp$rev <- 0
library(lubridate)
library(dplyr)
library(ggplot2)
library(stringr)
library(data.table)
load("~/ecb_project/data/full_dataset11_14.Rdata")
load("~/ecb_project/data/full_dataset15_23.Rdata")
df_full <- rbind(full_dataset11_14, full_dataset15_23)
#df_full$month <- month(ymd(df_full$date))
#df_full$spring <- 0
#df_full$spring[df_full$month <= 6] <- 1
df_full$ysp <- df_full$year + 0.5*(1 - df_full$spring)
df_full$country[df_full$country == "Czech Republic"] <- "Czechia"
df_full <- dplyr::rename(df_full, date_pred = date)
title <- as.data.frame(str_split_fixed(df_full$title, ":-", 2))
title <- dplyr::rename(title, title = V1, esa = V2)
new_df_full <- subset(df_full, select = -title)
df_full_spl <- cbind(new_df_full, title)
load("~/ecb_project/data/staff_nat.Rdata")
staff_nat <- dplyr::rename(staff_nat, date_ecfin = date)
staff_nat$year <- staff_nat$spring <- NULL
df_merged <- merge(df_full_spl, staff_nat, by = c("country","ysp"), all = TRUE)
pop <- read.csv("~/ecb_project/data/population.csv")
df_merged2 <- merge(df_merged, pop, by = c("country","ysp"), all = TRUE)
gdp_full <- read.csv("~/ecb_project/data/gdp.csv")
gdp <- subset(gdp_full, select = -c(iso2c,year,spring))
df_merged3 <- merge(df_merged2, gdp, by = c("country","ysp"), all = TRUE)
df_merged3$title[df_merged3$title == "Interest : general government "] <- "Interest: general government "
rev <- sort(unique(dfp$title[dfp$subchapter == "01 Revenue (ESA 2010)"]))
rev <- sort(unique(df_merged3$title[df_merged3$subchapter == "01 Revenue (ESA 2010)"]))
df_merged3$rev <- ifelse(df_merged3$title %in% rev,1,0)
summary(df_merged3$rev)
df_merged3$rev2 <- ifelse(df_merged3$title == "Actual social contributions received: general government " | df_merged3$title == "Capital taxes: general government " | df_merged3$title == "Capital transfers received: general government " | df_merged3$title == "Current tax burden: total economy " | df_merged3$title == "Current taxes on income and wealth (direct taxes): general government " | df_merged3$title == "Gross disposable income, general government " | df_merged3$title == "Gross saving: general government " | df_merged3$title == "Imputed social contributions: general government " | df_merged3$title == "Net disposable income: general government " | df_merged3$title == "Net saving: general government " | df_merged3$title == "Net social contributions received: general government " | df_merged3$title == "Other current revenue: general government " | df_merged3$title == "Other current revenue including sales: general government " | df_merged3$title == "Taxes linked to imports and production (indirect taxes): general government " | df_merged3$title == "Total current revenue: general government " | df_merged3$title == "Total revenue: general government ",1,0)
cor(df_merged3$rev, df_merged3$rev2)
?cor
cor(df_merged3$rev, df_merged3$rev2, use="complete.obs")
test <- subset(df_merged3, rev == 1 & rev2 == 0)
unique(test$title)
test <- subset(df_merged3, rev == 0 & rev2 == 1)
unique(test$title)
unique(df_merged3)
unique(df_merged3$subchapter)
unique(df_merged3$subchapter)
sort(unique(df_merged3$title[df_merged3$subchapter == "02 Expenditure (ESA 2010)"]))
sort(unique(df_merged3$title[df_merged3$subchapter == "03 Expenditure (ESA95)"]))
sort(unique(df_merged3$title[df_merged3$subchapter == "04 Expenditure (former definition)"]))
exp <- sort(unique(df_merged3$title[df_merged3$subchapter == "02 Expenditure (ESA 2010)"]))
df_merged3$exp <- ifelse(df_merged3$title %in% exp,1,0) # includes total tax burden, which the last one didn't
summary(df_merged3$exp)
df_merged3$exp2 <- ifelse(df_merged3$title == "Capital transfers paid: general government " | df_merged3$title == "Collective consumption expenditure " | df_merged3$title == "Compensation of employees: general government " | df_merged3$title == "Final consumption expenditure of general government " | df_merged3$title == "Gross fixed capital formation: general government " | df_merged3$title == "Interest : general government " | df_merged3$title == "Interest including flows on swaps and FRAs (Forward Rate Agreements): general government " | df_merged3$title == "Interest: general government " | df_merged3$title == "Intermediate consumption: general government " | df_merged3$title == "Other capital expenditure, including capital transfers: general government " | df_merged3$title == "Other current expenditure: general government " | df_merged3$title == "Social benefits other than social transfers in kind: general government " | df_merged3$title == "Social transfers in kind " | df_merged3$title == "Social transfers in kind supplied to households via market producers: general government " | df_merged3$title == "Subsidies: general government " | df_merged3$title == "Total current expenditure excluding interest: general government " | df_merged3$title == "Total current expenditure: general government " | df_merged3$title == "Total expenditure: general government ",1,0)
test <- subset(df_merged3, exp == 1 & exp2 ==0)
View(test)
unique(test$title)
sort(exp)
test <- subset(df_merged3, exp == 0 & exp2 ==1)
unique(test$title)
test <- subset(df_merged3, exp == 1 & exp2 ==0)
sort(unique(test$title))
sort(unique(df_merged3$title[df_merged3$subchapter == "02 Expenditure (ESA 2010)"]))
sort(unique(df_merged3$title[df_merged3$subchapter == "02 Expenditure (ESA95)"]))
sort(unique(df_merged3$title[df_merged3$subchapter == ""]))
sort(unique(df_merged3$subchapter))
sort(unique(df_merged3$title[df_merged3$subchapter == "03 Net lending (ESA 2010)"]))
sort(unique(df_merged3$title[df_merged3$subchapter == "02 Revenue (former definition)"]))
sort(unique(df_merged3$title[df_merged3$subchapter == "04 Expenditure (former definition)"]))
lend <- sort(unique(df_merged3$title[df_merged3$subchapter == "03 Net lending (ESA 2010)"]))
df_merged3$lend <- ifelse(df_merged3$title %in% lend,1,0) # I think I just missed or misspelled some of these?
df_merged3$lend <- ifelse(df_merged3$title == "Net lending (+) or net borrowing (-) excluding gross fixed capital formation: general government " | df_merged3$title == "Net lending (+) or net borrowing (-) excluding interest: general government " | df_merged3$title == "Net lending (+) or net borrowing (-): general government ",1,0)
df_merged3$lend <- ifelse(df_merged3$title %in% lend,1,0) # I think I just missed or misspelled some of these?
df_merged3$lend2 <- ifelse(df_merged3$title == "Net lending (+) or net borrowing (-) excluding gross fixed capital formation: general government " | df_merged3$title == "Net lending (+) or net borrowing (-) excluding interest: general government " | df_merged3$title == "Net lending (+) or net borrowing (-): general government ",1,0)
cor(df_merged3$lend, df_merged3$lend2, use = "complete.obs")
summary(df_merged3$ysp[df_merged3$lend == 1])
summary(df_merged3$ysp[df_merged3$title == "Net lending (+) or net borrowing (-): general government "])
?Rscript
Rscript(pooled data.R)
Rscript("pooled data.R")
source("pooled data.R", echo = TRUE)
source("~/ecb_project/code/pooled data.R", echo = TRUE)
source("~/ecb_project/code/merge_datasets.R", echo=TRUE)
source("~/ecb_project/code/merge_datasets.R", echo=TRUE)
#table 1
all <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp)
library(ggplot2)
library(fixest)
library(stargazer)
library(dplyr)
library(plyr)
library(tidyr)
library(data.table)
# pooled predictions
load("~/ecb_project/data/final_dataset_euro_pooled.Rdata")
setDT(dfp)
#table 1
all <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp)
rev <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, rev == 1))
test <- subset(dfp, rev == 1)
source("~/ecb_project/code/pooled data.R", echo=TRUE)
# pool predictions dataset
df <- read.csv("~/ecb_project/data/final_dataset_euro.csv")
p0 <- subset(df, select = c("ecfin", "ecfin_int", "pop_int", "gdp", "country", "ysp", "subchapter", "title", "err0", "err0_sq", "rev", "exp", "lend", "spring"))
p0$py <- 0
p0 <- p0 %>% rename(err_sq = err0_sq, err = err0)
source("~/ecb_project/code/pooled data.R", echo=TRUE)
source("~/ecb_project/code/pooled data.R", echo=TRUE)
# pool predictions dataset
df <- read.csv("~/ecb_project/data/final_dataset_euro.csv")
sort(colnames(df))
p0 <- subset(df, select = c("ecfin", "ecfin_int", "pop_int", "gdp", "country", "ysp", "subchapter", "title", "err0", "err0_sq", "rev", "exp", "lend", "spring"))
function (.data, ...)
p0$py <- 0
View(df)
p0$py <- 0
p0 <- dplyr::rename(err_sq = err0_sq, err = err0)
p0 <- p0 %>% dplyr::rename(err_sq = err0_sq, err = err0)
source("~/ecb_project/code/pooled data.R", echo=TRUE)
load("~/ecb_project/data/final_dataset_euro_pooled.Rdata")
setDT(dfp)
rev <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, rev == 1))
all <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp)
rev <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, rev == 1))
exp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, exp == 1))
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, lend == 1))
etable(all,rev,exp,lend, tex=F)
dfp_noA <- subset(dfp, aeoy == 0)
all2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp_noA)
rev2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, rev == 1))
exp2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, exp == 1))
lend2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, lend == 1))
etable(all2,rev2,exp2,lend2, tex=T)
etable(all2,rev2,exp2,lend2, tex=F)
dfp_noEOY <- subset(dfp, dfp$py != 0)
all3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp_noEOY)
rev3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, rev == 1))
exp3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, exp == 1))
lend3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, lend == 1))
etable(all3, rev3, exp3, lend3, tex = T)
etable(all3, rev3, exp3, lend3, tex = F)
sort(unique(dfp$title))
test <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, title == "Total expenditure: general government "))
etable(test)
test <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+py, data = subset(dfp_noEOY, title == "Total expenditure: general government "))
etable(test)
sort(unique(dfp$title))
test <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+py, data = subset(dfp_noEOY, title == "Net lending (+) or net borrowing (-): general government "))
etable(test)
test1 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+py, data = subset(dfp_noEOY, title == "Total revenue: general government "))
test2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+py, data = subset(dfp_noEOY, title == "Total expenditure: general government "))
test3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+py, data = subset(dfp_noEOY, title == "Net lending (+) or net borrowing (-): general government "))
etable(test1,test2,test3)
new_df <- subset(dfp_noEOY, title == "Total revenue: general government ")
#table 1
all <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp)
rev <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, rev == 1))
exp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, exp == 1))
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, lend == 1))
etable(all,rev,exp,lend, tex=F)
dfp_noA <- subset(dfp, aeoy == 0)
all2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp_noA)
rev2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, rev == 1))
exp2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, exp == 1))
lend2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, lend == 1))
etable(all2,rev2,exp2,lend2, tex=F)
dfp_noEOY <- subset(dfp, dfp$py != 0)
all3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp_noEOY)
rev3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, rev == 1))
exp3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, exp == 1))
lend3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, lend == 1))
etable(all3, rev3, exp3, lend3, tex = F)
new <- subset(dfp, title = "Total revenue: general government ")
new <- subset(dfp, title == "Total revenue: general government ")
View(new)
summary(new$rev)
test1 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+py, data = subset(dfp_noEOY, title == "Total revenue: general government "))
test2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+py, data = subset(dfp_noEOY, title == "Total expenditure: general government "))
test3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+py, data = subset(dfp_noEOY, title == "Net lending (+) or net borrowing (-): general government "))
etable(test1,test2,test3) #
library(lubridate)
library(dplyr)
library(ggplot2)
library(stringr)
library(data.table)
load("~/ecb_project/data/full_dataset11_14.Rdata")
load("~/ecb_project/data/full_dataset15_23.Rdata")
df_full <- rbind(full_dataset11_14, full_dataset15_23)
#df_full$month <- month(ymd(df_full$date))
#df_full$spring <- 0
#df_full$spring[df_full$month <= 6] <- 1
df_full$ysp <- df_full$year + 0.5*(1 - df_full$spring)
df_full$country[df_full$country == "Czech Republic"] <- "Czechia"
df_full <- dplyr::rename(df_full, date_pred = date)
title <- as.data.frame(str_split_fixed(df_full$title, ":-", 2))
title <- dplyr::rename(title, title = V1, esa = V2)
new_df_full <- subset(df_full, select = -title)
df_full_spl <- cbind(new_df_full, title)
load("~/ecb_project/data/staff_nat.Rdata")
staff_nat <- dplyr::rename(staff_nat, date_ecfin = date)
staff_nat$year <- staff_nat$spring <- NULL
df_merged <- merge(df_full_spl, staff_nat, by = c("country","ysp"), all = TRUE)
pop <- read.csv("~/ecb_project/data/population.csv")
df_merged2 <- merge(df_merged, pop, by = c("country","ysp"), all = TRUE)
gdp_full <- read.csv("~/ecb_project/data/gdp.csv")
gdp <- subset(gdp_full, select = -c(iso2c,year,spring))
df_merged3 <- merge(df_merged2, gdp, by = c("country","ysp"), all = TRUE)
df_merged3$title[df_merged3$title == "Interest : general government "] <- "Interest: general government "
rev <- sort(unique(df_merged3$title[df_merged3$subchapter == "01 Revenue (ESA 2010)"]))
df_merged3$rev <- ifelse(df_merged3$title %in% rev,1,0) # includes total tax burden, which the last one didn't
#df_merged3$rev2 <- ifelse(df_merged3$title == "Actual social contributions received: general government " | df_merged3$title == "Capital taxes: general government " | df_merged3$title == "Capital transfers received: general government " | df_merged3$title == "Current tax burden: total economy " | df_merged3$title == "Current taxes on income and wealth (direct taxes): general government " | df_merged3$title == "Gross disposable income, general government " | df_merged3$title == "Gross saving: general government " | df_merged3$title == "Imputed social contributions: general government " | df_merged3$title == "Net disposable income: general government " | df_merged3$title == "Net saving: general government " | df_merged3$title == "Net social contributions received: general government " | df_merged3$title == "Other current revenue: general government " | df_merged3$title == "Other current revenue including sales: general government " | df_merged3$title == "Taxes linked to imports and production (indirect taxes): general government " | df_merged3$title == "Total current revenue: general government " | df_merged3$title == "Total revenue: general government ",1,0)
exp <- sort(unique(df_merged3$title[df_merged3$subchapter == "02 Expenditure (ESA 2010)"]))
df_merged3$exp <- ifelse(df_merged3$title %in% exp,1,0) # I think I just missed or misspelled some of these?
lend <- sort(unique(df_merged3$title[df_merged3$subchapter == "03 Net lending (ESA 2010)"]))
df_merged3$lend <- ifelse(df_merged3$title %in% lend,1,0) # exact same as before, but doesn't get tracked until
sort(unique(df_merged3$subchapter))
edp <- sort(unique(df_merged3$title[df_merged3$subchapter == "04 Excessive deficit procedure"]))
edp
df_merged3$edp <- ifelse(df_merged3$title %in% edp,1,0) # exact same as before, but doesn't get tracked until
summary(df_merged3$edp)
source("~/ecb_project/code/merge_datasets.R", echo=TRUE)
edp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, edp == 1))
etable(all,rev,exp,lend,edp, tex=F)
all <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp)
load("~/ecb_project/data/final_dataset_euro_pooled.Rdata")
setDT(dfp)
#table 1
all <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp)
rev <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, rev == 1))
exp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, exp == 1))
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, lend == 1))
edp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, edp == 1))
source("~/ecb_project/code/pooled data.R", echo=TRUE)
load("~/ecb_project/data/final_dataset_euro_pooled.Rdata")
setDT(dfp)
#table 1
all <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp)
rev <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, rev == 1))
exp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, exp == 1))
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, lend == 1))
edp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, edp == 1))
View(dfp)
# pool predictions dataset
df <- read.csv("~/ecb_project/data/final_dataset_euro.csv")
load("~/ecb_project/data/final_dataset_euro.Rdata")
source("~/ecb_project/code/merge_datasets.R", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
df_merged_FULL <- merge(df, gne_merge, by = c("country","ysp"), all = TRUE)
dfg <- subset(df_merged_FULL, select=which(!duplicated(names(df_merged_FULL))))
source("~/ecb_project/code/merge_datasets.R", echo=TRUE)
all <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp)
rev <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, rev == 1))
exp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, exp == 1))
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, lend == 1))
edp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, edp == 1))
etable(all,rev,exp,lend,edp, tex=F)
all2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp_noA)
dfp_noA <- subset(dfp, aeoy == 0)
all2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp_noA)
rev2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, rev == 1))
exp2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, exp == 1))
lend2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, lend == 1))
edp2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, edp == 1))
etable(all2,rev2,exp2,lend2, tex=F)
etable(all2,rev2,exp2,lend2,edp2, tex=F)
dfp_noEOY <- subset(dfp, dfp$py != 0)
all3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp_noEOY)
rev3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, rev == 1))
exp3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, exp == 1))
lend3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, lend == 1))
edp3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, edp == 1))
etable(all3, rev3, exp3, lend3,edp3, tex = F)
df <- read.csv("~/ecb_project/data/final_dataset_euro.csv")
load("~/ecb_project/data/final_dataset_euro.Rdata")
source("~/.active-rstudio-document", echo=TRUE)
ggplot(subset(df, title =  == "Total revenue: general government ")) +
ggplot(subset(df, title  == "Total revenue: general government ")) +
geom_point(aes(x=ysp,y=err0)) +
facet_wrap(~country)
df <- subset(df, !is.na(ecfin))
ggplot(subset(df, title  == "Total revenue: general government ")) +
geom_point(aes(x=ysp,y=err0)) +
facet_wrap(~country)
ggplot(data = NULL) +
geom_point(aes(x=ysp,y=err0), data = subset(df, title  == "Total revenue: general government ")) +
facet_wrap(~country, data = df)
ggplot(data = NULL) +
geom_point(aes(x=ysp,y=err0), data = subset(df, title  == "Total revenue: general government ")) +
facet_wrap(~country, data = df)
ggplot(data = NULL) +
geom_point(aes(x=ysp,y=err0), data = subset(df, title  == "Total revenue: general government ")) +
facet_wrap(~country)
ggplot(data = NULL) +
geom_point(aes(x=ysp,y=err0), data = subset(df, title  == "Total revenue: general government ")) +
geom_point(aes(x=ysp,y=err0), data = subset(df, title  == "Total expenditure: general government "), color = "red") +
geom_point(aes(x=ysp,y=err0), data = subset(df, title  == "Net lending (+) or net borrowing (-): general government "), color = "blue") +
facet_wrap(~country)
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, lend == 1 & (ysp < 2018 | ysp > 2020))
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, lend == 1 & (ysp < 2018 | ysp > 2020)))
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, lend == 1 & (ysp < 2018 | ysp > 2020)))
load("~/ecb_project/data/final_dataset_euro_pooled.Rdata")
setDT(dfp)
#table 1
all <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp)
rev <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, rev == 1))
exp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, exp == 1))
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, lend == 1 & (ysp < 2018 | ysp > 2020)))
edp <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, edp == 1))
etable(all,rev,exp,lend,edp, tex=F)
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, lend == 1 & (ysp < 2018 | ysp > 2021)))
etable(all,rev,exp,lend,edp, tex=F)
lend <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp, lend == 1 & year < 2018))
etable(all,rev,exp,lend,edp, tex=F)
dfp_noA <- subset(dfp, aeoy == 0)
all2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp_noA)
rev2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, rev == 1))
exp2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, exp == 1))
lend2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, lend == 1))
edp2 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noA, edp == 1))
etable(all2,rev2,exp2,lend2,edp2, tex=F)
dfp_noEOY <- subset(dfp, dfp$py != 0)
all3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = dfp_noEOY)
rev3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, rev == 1))
exp3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, exp == 1))
lend3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, lend == 1))
edp3 <- feols(log(err_sq) ~ ecfin + pop_int + gdp|country+ysp+title+py, data = subset(dfp_noEOY, edp == 1))
etable(all3, rev3, exp3, lend3,edp3, tex = F)
